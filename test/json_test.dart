import 'package:test/test.dart';
import 'package:hn_app/json_parsing.dart';

/// 单元测试
void main() {
  test("parse_topstories.json", () {
    const jsonString =
        "[26296339,26294552,26296845,26299913,26298462,26298022,26297040,26295100,26284253,26297984,26284449,26291145,26295065,26292687,26298674,26296315,26295435,26298075,26299741,26298564,26294693,26295792,26293079,26299561,26294397,26294972,26295177,26294386,26296870,26291215,26298738,26273813,26294096,26299444,26299786,26294588,26299188,26298842,26291402,26295774,26283343,26297204,26294052,26285338,26293171,26290955,26271117,26298516,26273874,26296915,26292744,26289591,26293943,26292166,26296397,26273169,26290705,26273866,26296318,26294259,26284635,26291756,26283742,26291705,26289933,26292299,26291975,26273428,26295875,26297771,26273027,26292781,26277602,26292786,26263508,26293172,26293347,26274314,26287879,26289621,26291420,26292310,26299216,26286194,26291211,26296649,26290324,26291819,26285687,26291126,26296825,26284087,26295071,26293424,26288749,26297407,26285926,26292660,26296289,26296082,26290223,26273030,26292427,26287728,26280266,26281103,26283984,26292235,26284158,26287948,26287527,26265872,26285655,26273670,26286734,26298772,26287868,26287811,26288772,26293457,26262038,26296516,26285645,26284982,26262465,26290252,26289200,26282433,26289245,26291970,26292704,26283385,26294508,26284294,26286991,26251143,26276179,26298474,26284618,26292832,26290565,26298958,26290309,26295832,26293703,26263149,26287590,26295629,26290174,26298278,26292666,26284529,26283651,26284630,26290343,26288387,26284782,26262170,26237404,26282213,26275091,26284976,26285683,26293190,26285144,26283348,26284750,26272084,26277501,26283208,26290851,26289552,26274516,26288080,26283650,26295414,26265999,26287381,26291438,26272529,26248123,26283637,26249236,26240581,26295848,26273925,26281689,26282828,26275289,26271851,26251060,26277396,26273735,26253281,26288708,26285178,26270251,26262989,26273340,26288713,26274466,26286862,26279468,26282966,26290718,26274698,26271388,26273594,26280357,26251567,26283535,26261675,26249380,26259955,26252010,26271800,26239711,26293692,26280808,26289080,26287535,26286015,26262077,26285185,26286772,26273960,26282742,26279630,26275400,26296669,26278241,26260390,26269832,26282119,26252348,26295210,26275488,26280664,26261314,26280130,26285843,26265603,26256459,26260710,26266881,26282500,26282771,26267322,26272368,26279372,26276520,26238376,26298588,26251322,26271743,26281108,26281823,26247348,26286940,26285894,26264257,26261337,26286861,26294500,26250809,26272092,26294481,26278052,26276449,26267891,26290634,26279744,26275071,26281864,26262213,26276023,26274618,26283841,26254785,26270957,26290383,26271582,26291644,26272825,26248595,26233736,26290128,26272170,26268460,26233683,26254991,26287825,26271045,26247278,26258773,26263085,26284669,26259834,26275553,26264378,26274450,26261327,26285456,26266289,26280845,26288454,26272642,26248571,26248668,26267216,26251337,26250929,26275754,26248980,26289224,26291399,26258081,26244829,26262148,26286146,26279891,26245563,26249143,26284161,26285780,26287081,26280727,26268528,26257839,26246049,26240339,26247052,26235414,26249254,26273273,26263942,26274358,26270042,26277386,26271470,26294215,26275335,26249366,26247871,26247954,26267707,26248603,26263264,26249175,26270013,26244093,26272492,26265957,26291321,26298180,26249242,26248003,26257264,26260524,26242495,26270182,26262653,26286306,26230732,26260235,26236325,26292374,26261098,26261341,26265024,26243495,26236910,26292294,26243964,26284382,26250504,26275370,26258417,26258610,26258695,26256726,26274667,26267529,26237368,26266570,26238262,26287704,26248002,26262687,26282216,26231418,26263408,26235812,26260174,26247260,26245550,26255325,26293050,26265528,26244281,26261310,26286958,26289994,26260165,26237823,26235820,26272062,26247813,26244528,26257982,26233244,26231920,26298195,26248349,26248600,26285527,26275976,26236450,26247933,26239975,26264045,26234540,26280141,26287908,26289827,26242264,26258073,26236908,26241780,26289349,26234154,26282202,26287437,26243116,26247266,26270046,26234614,26236739,26267966,26274022,26279330,26277493,26262192,26263342,26236772,26247299,26240901,26288201,26266420,26264992,26252373,26254955,26230992,26259007,26235896,26250800,26246116,26268433,26243139,26232600,26285158,26245502,26237048,26239151,26262150,26290759,26259712,26287938,26281528,26258261,26250972,26271324,26239236,26266159,26248134,26252809,26279784,26252472,26239231,26270207,26263829,26239156,26260127,26231212,26289439,26247821,26246619,26270292,26278631,26239068,26235860,26269812,26291577,26237886,26279362,26270995,26286217,26257959,26283309,26267476]";

    expect(parseTopStories(jsonString).first, 26296339);
  });

  test("parse_item.json", () {
    const jsonString =
        """{"by":"dhouston","descendants":71,"id":8863,"kids":[9224,8917,8952,8958,8884,8887,8869,8940,8908,9005,8873,9671,9067,9055,8865,8881,8872,8955,10403,8903,8928,9125,8998,8901,8902,8907,8894,8870,8878,8980,8934,8943,8876],"score":104,"time":1175714200,"title":"My YC app: Dropbox - Throw away your USB drive","type":"story","url":"http://www.getdropbox.com/u/2/screencast.html"}""";

    expect(parseArticle(jsonString).by, "dhouston");
  });
}
